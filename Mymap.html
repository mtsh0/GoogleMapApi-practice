<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Mymap</title>
  <style>
    #target {
      width: 550px;
      height: 200px;
    }

  </style>
</head>
<body>
  <div id="target"></div>
  <input type="text" id="keyword">
  <button id="search">search</button>
  <script src="https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=AIzaSyA9LcEu99UT8OzJ2PcmLaE9K0UXrt1VdIk&callback=initMap&libraries=places" async defer></script>
  <script>
    function initMap(){
      'use strict';

      var target = document.getElementById('target');
      var map;
      var tokyo = {lat: 35.681167, lng: 139.767052}
      // places用の変数の定義
      var service;
      // マップのインスタンスを生成
      map = new google.maps.Map(target, {
        center: tokyo,
        zoom: 14
      });

      document.getElementById('search').addEventListener('click', function(){
        // places
        service = new google.maps.places.PlacesService(map);
        // 入力内容をもとに施設内容の検索
        service.nearbySearch({
          // 東京を中心に
          location: tokyo,
          // 半径500m以内
          radius: '500',
          // 検索内容
          name: document.getElementById('keyword').value
        }, function(results, status){
          // 情報の受け取りに成功した場合
          if (status === google.maps.places.PlacesServiceStatus.OK) {
            // 受け取った情報をすべて表示するためにfor文を利用
            var i;
            for (i = 0; i < results.length; i++){
              // マーカーの作成、表示
              new google.maps.Marker({
                // 表示するマップを指定
                map: map,
                // マーカーの表示する場所を設定
                position: results[i].geometry.location,
                // マーカーの名称を設定
                title: results[i].name
              });
            }
          } else {
            // 情報の受け取りに失敗した場合
            alert('Failed: ' + status);
            return;
          }
        });
      });
    }
  </script>
</body>
</html>
